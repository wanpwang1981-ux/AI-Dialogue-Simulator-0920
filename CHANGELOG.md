# 修改歷程 (Changelog)

本檔案記錄了 "AI Debate Club" 專案的所有主要版本變更。

---

## [1.48] - 2025-09-17

### 修正 (Fixed)
- **修正儲存按鈕佈局**: 調整了UI排版，解決了「儲存對話紀錄」按鈕在某些情況下會被隱藏的問題。

### 優化 (Improved)
- **新增選單儲存選項**: 在「檔案」選單中新增了「儲存對話紀錄...」選項，提供另一種存檔的快捷方式。

---

## [1.47] - 2025-09-17

### 修正 (Fixed)
- **修正風格編輯視窗佈局**: 調整了 `StyleEditorWindow` 的預設高度，以解決「儲存/取消」按鈕在開啟時可能被隱藏的UI問題。

---

## [1.46] - 2025-09-17

### 修正 (Fixed)
- **修正 `NameError` 啟動錯誤**: 修正了因 `app.py` 試圖使用未被匯入的 `HistoryManagerWindow` 類別而導致的程式啟動失敗問題。

---

## [1.45] - 2025-09-16

### 新增 (Added)
- **對話歷史紀錄管理**:
    - 新增 `history` 資料夾，用於自動儲存每一場對話的 `.txt` 和 `.json` 紀錄。
    - 新增「對話歷史紀錄」管理介面，提供檢視與刪除歷史紀錄的功能。
- **獨立匯出/匯入功能**: 將原有的整合式設定備份，拆分為獨立的「匯出/匯入角色庫」和「匯出/匯入風格庫」，使用獨立的JSON檔案，讓管理更具彈性。

### 修正 (Fixed)
- **修正儲存錯誤**: 修正了因缺少 `output_formatter` 模組匯入而導致的 `NameError` 存檔失敗問題。
- **修正Ollama超時問題**: 延長了請求的超時時間，並在發生超時錯誤時，會在UI上顯示提示訊息。
- **修正編輯視窗佈局**: 調整了角色與風格編輯視窗的預設大小與佈局，確保「儲存/取消」按鈕在開啟時即可見。

---

## [1.44] - 2025-09-16

### 新增 (Added)
- **對話風格管理系統**: 新增了完整的對話風格管理功能，使用者現在可以建立、編輯、刪除並儲存自訂的風格指令，並透過下拉選單快速選用。
- **設定匯出/匯入功能**: 在「檔案」選單中新增了匯出與匯入功能，可將所有使用者設定（API金鑰、自訂角色、自訂風格）備份至單一JSON檔案，或從檔案中還原。

### 修正 (Fixed)
- **修正儲存錯誤**: 修正了因缺少 `output_formatter` 模組匯入而導致的 `NameError` 存檔失敗問題。
- **修正編輯視窗佈局**: 調整了角色編輯視窗的預設大小，確保「儲存/取消」按鈕在開啟時即可見。

### 優化 (Improved)
- **優化主視窗顯示**: 讓主視窗在啟動時預設最大化，以適應不同螢幕解析度並確保所有元件可見。

---

## [1.42] - 2025-09-16

### 修正 (Fixed)
- **修正 `TypeError` 啟動錯誤**: 修正了因 `app.py` 傳遞 `persona_manager_command` 參數給 `ui.py`，但 `ui.py` 的 `__init__` 函式未準備好接收此參數而導致的程式啟動失敗問題。

---

## [1.41] - 2025-09-16

### 修正 (Fixed)
- **修正角色庫更新邏輯**: 解決了在「我的角色庫」中新增、編輯或刪除角色後，主畫面的角色下拉選單沒有同步更新的問題。
- **修正 `NameError`**: 修正了因缺少 `messagebox` 模組匯入而可能導致的啟動錯誤。

---

## [1.4] - 2025-09-16

### 新增 (Added)
- **角色管理系統**:
    - 新增「我的角色庫」管理介面，讓使用者可以新增、編輯、刪除自訂的角色。
    - 使用者的自訂角色會被儲存在 `user_personas.json` 檔案中，並與預設角色一起顯示在下拉選單中。
- **對話風格指令**: 新增「對話風格指令」輸入框，允許使用者輸入一段共同指令，該指令會被附加到雙方AI的提示詞末尾，用以控制整場對話的基調。

---

## [1.3] - 2025-09-15

### 新增 (Added)
- **版本資訊顯示**: UI介面的標題列與右下角狀態列會顯示目前的應用程式版本。
- **修改歷程檔案**: 建立了此 `CHANGELOG.md` 檔案，用以記錄各版本的功能變更。

---

## [1.24] - 2025-09-15

### 修正 (Fixed)
- **修正儲存邏輯**: 解決了對話開頭的「角色介紹」區塊沒有被儲存到 `.txt` 和 `.md` 檔案中的問題。
- **優化資料格式儲存**: 確保 `.csv` 和 `.xlsx` 檔案在儲存時會過濾掉「角色介紹」區塊，以保持其表格結構的純粹性，方便後續資料分析。

---

## [1.23] - 2025-09-15

### 新增 (Added)
- **優化對話紀錄格式**:
    - 在對話紀錄開頭新增了詳細的「角色介紹」區塊，包含雙方的角色名稱與完整的提示詞。
    - 將每一回合的標題格式更新，現在會同時顯示角色名稱與所使用的模型（例如：`第一回合對話 (角色A：蘇格拉底老師, 模型：llama3)`）。

### 變更 (Changed)
- **更新UI文字**: 將儲存按鈕的文字從「儲存成 .txt」變更為更通用的「儲存對話紀錄」。

---

## [1.22] - 2025-09-15

### 新增 (Added)
- **新增Word與Excel儲存格式**: 擴充存檔功能，現在支援將對話紀錄儲存為 `.docx` (Word) 和 `.xlsx` (Excel) 格式。
- **豐富對話上下文**: 在對話紀錄的開頭加入了雙方AI的角色設定描述。

### 優化 (Improved)
- **修正UI卡頓問題**: 將獲取本地Ollama模型列表的操作移至背景執行緒處理，解決了在切換模型來源時可能導致的介面卡頓問題，提升了操作流暢度。

---

## [1.21] - 2025-09-15

### 修正 (Fixed)
- **修正程式啟動錯誤**: 修正了因 `tkinter` 選單事件綁定方式不正確而導致的 `bad menu entry index` 啟動錯誤。

### 優化 (Improved)
- **智慧API金鑰提示**: 當使用者選擇 "Gemini" 作為模型來源但尚未設定API金鑰時，程式會自動彈出設定視窗，引導使用者輸入金鑰，提升了使用者體驗。

---

## [1.2] - 2025-09-15

### 新增 (Added)
- **整合Google Gemini**: 新增對Google Gemini雲端模型的支援，使用者現在可以選擇使用本地Ollama或雲端Gemini模型。
- **API金鑰管理**: 新增了「設定」選單與「API金鑰管理」視窗，讓使用者可以輸入、儲存和驗證自己的Gemini API Key。
- **模型來源選擇**: UI中新增了選項按鈕，可為每個AI獨立選擇模型來源。
- **新增CSV與Markdown儲存格式**: 擴充存檔功能，支援 `.csv` 和 `.md` 格式。

---

## [1.11] - 2025-09-15

### 新增 (Added)
- **角色下拉式選單**: 將手動輸入角色的文字框升級為下拉式選單，程式會自動從 `DEFAULT_PERSONAS.md` 讀取所有可用角色，大幅簡化了角色選擇流程。

### 優化 (Improved)
- **強制繁體中文輸出**: 在所有預設角色的提示詞中，加入了「所有回覆都必須使用繁體中文」的明確指令，以統一輸出語言。

---

## [1.1] - 2025-09-15

### 新增 (Added)
- **預設角色自動載入**: 程式啟動時，會自動從 `DEFAULT_PERSONAS.md` 讀取並載入前兩個角色作為預設值。
- **優化存檔檔名**: 存檔時，會自動產生以當前日期時間為格式 (`YYYYMMDDHHMM.txt`) 的預設檔名。

### 優化 (Improved)
- **本地化**: 將 `DEFAULT_PERSONAS.md` 檔案的內容翻譯為繁體中文。

---

## [1.0] - 2025-09-15

### 新增 (Added)
- **專案創立**: 建立具備核心功能的最小可行產品 (MVP)。
- **模組化架構**: 設計並建立了清晰的模組化專案結構 (`app.py`, `ui.py`, `ollama_client.py`, `conversation_manager.py`)。
- **本地Ollama對話**: 實現了兩個本地Ollama模型之間的基本對話功能。
- **核心UI**: 建立了基於 `tkinter` 的圖形化使用者介面，包含模型選擇、角色輸入、主題設定等功能。
- **純文字存檔**: 支援將對話紀錄儲存為 `.txt` 檔案。
- **專案文件**: 建立了 `README.md`, `DESIGN_PLAN.md`, `ARCHITECTURE.md` 等初始專案文件。
